############################
#
# Civilian Trade Events
#
# Written by Kyoj1n
#
############################

namespace = civtradebonus

planet_event = {
	id = civtradebonus.1
	hide_window = yes
	location = ROOT
	
	trigger = {
		has_owner = yes
		owner = { is_country_type = default }
		has_planet_flag = trade_planet
		has_planet_flag = small_population
	}
	immediate = {
		every_planet = {
			limit = {
				distance = {
					source = root
					max_distance = 60
					min_distance = 1
				}
				or = {
					not = { 
						or = {
							has_modifier = "trade_network" 	
							has_modifier = "foriegn_trade_network" 	
						}
					}
					root = {
						has_edict = production_targets								
						has_edict = capacity_overload					
					}
				
				}

				is_colony = yes
				not = { owner = { has_closed_borders = root.owner } }
			}
			if = {
				limit = {
					owner = {
						not = { is_same_value = root.owner }
					}
				}
				add_modifier = {
					modifier = "foriegn_trade_network"
					days = -1
				}
				else = {
					if = {
						limit = {
							root = {
								has_edict = capacity_overload
							}
						}
						add_modifier = {
							modifier = "trade_network_energy"
							days = -1
						}
					}
					if = {
						limit = {
							root = {
								has_edict = production_targets
							}
						}
						add_modifier = {
							modifier = "trade_network_minerals"
							days = -1
						}

					}
					if = {
						limit = {
							root = {
								not = {
									has_edict = production_targets								
									has_edict = capacity_overload
								}
							}
						}						
						add_modifier = {
							modifier = "trade_network"
							days = -1
						}									
					}						
					
				}
			}
		}
	}	
}

planet_event = {
	id = civtradebonus.2
	hide_window = yes
	location = ROOT
	
	trigger = {
		has_owner = yes
		owner = { is_country_type = default }
		has_planet_flag = trade_planet
		has_planet_flag = medium_population
	}
	immediate = {
		every_planet = {
			limit = {
				distance = {
					source = root
					max_distance = 60
					min_distance = 1
				}
				or = {
					not = { 
						or = {
							has_modifier = "trade_network" 	
							has_modifier = "foriegn_trade_network" 	
						}
					}
					root = {
						has_edict = production_targets								
						has_edict = capacity_overload					
					}
				
				}

				is_colony = yes
				not = { owner = { has_closed_borders = root.owner } }
			}
			if = {
				limit = {
					owner = {
						not = { is_same_value = root.owner }
					}
				}
				add_modifier = {
					modifier = "foriegn_trade_network"
					days = -1
				}
				else = {
					if = {
						limit = {
							root = {
								has_edict = capacity_overload
							}
						}
						add_modifier = {
							modifier = "trade_network_energy"
							days = -1
						}
					}
					if = {
						limit = {
							root = {
								has_edict = production_targets
							}
						}
						add_modifier = {
							modifier = "trade_network_minerals"
							days = -1
						}

					}
					if = {
						limit = {
							root = {
								not = {
									has_edict = production_targets								
									has_edict = capacity_overload
								}
							}
						}						
						add_modifier = {
							modifier = "trade_network"
							days = -1
						}									
					}						
					
				}
			}
		}
	}	
}

planet_event = {
	id = civtradebonus.3
	hide_window = yes
	location = ROOT
	
	trigger = {
		has_owner = yes
		owner = { is_country_type = default }
		has_planet_flag = trade_planet
		has_planet_flag = large_population
	}
	immediate = {
		every_planet = {
			limit = {
				distance = {
					source = root
					max_distance = 60
					min_distance = 1
				}
				or = {
					not = { 
						or = {
							has_modifier = "trade_network" 	
							has_modifier = "foriegn_trade_network" 	
						}
					}
					root = {
						has_edict = production_targets								
						has_edict = capacity_overload					
					}
				
				}

				is_colony = yes
				not = { owner = { has_closed_borders = root.owner } }
			}
			if = {
				limit = {
					owner = {
						not = { is_same_value = root.owner }
					}
				}
				add_modifier = {
					modifier = "foriegn_trade_network"
					days = -1
				}
				else = {
					if = {
						limit = {
							root = {
								has_edict = capacity_overload
							}
						}
						add_modifier = {
							modifier = "trade_network_energy"
							days = -1
						}
					}
					if = {
						limit = {
							root = {
								has_edict = production_targets
							}
						}
						add_modifier = {
							modifier = "trade_network_minerals"
							days = -1
						}

					}
					if = {
						limit = {
							root = {
								not = {
									has_edict = production_targets								
									has_edict = capacity_overload
								}
							}
						}						
						add_modifier = {
							modifier = "trade_network"
							days = -1
						}									
					}						
					
				}
			}
		}
	}	
}

event = {
	id = civtradebonus.4
	hide_window = yes
	location = ROOT
	is_triggered_only = yes
	trigger = {
		any_country = {
				is_country_type = default
			any_owned_planet = {
				or = {
				has_modifier = "trade_network" 	
				has_modifier = "foriegn_trade_network"
				has_modifier = "trade_network_energy"
				has_modifier = "trade_network_minerals" 				
				}
				
			}
		
		}
	
			
	}

	immediate = {
		every_country = {
			limit = {
				is_country_type = default
				any_owned_planet = {
					or = {
						has_modifier = "trade_network" 	
						has_modifier = "foriegn_trade_network"
						has_modifier = "trade_network_energy"
						has_modifier = "trade_network_minerals" 
					}
				
				}
			}
			every_owned_planet = {
				limit = {
					or = {
						has_modifier = "trade_network" 	
						has_modifier = "foriegn_trade_network"
						has_modifier = "trade_network_energy"
						has_modifier = "trade_network_minerals" 						
					}
				}
				remove_modifier = "trade_network"
				remove_modifier = "foriegn_trade_network"
				remove_modifier = "trade_network_energy"
				remove_modifier = "trade_network_minerals"
			}		
		}
	}	
}
# add minerals for when a mineral ship arrives at a planet
country_event = {
	id = civtradebonus.5
	hide_window = yes
	is_triggered_only = yes
	trigger = {

	}
	immediate = {
		add_minerals = 10
	}	
}
# add energy for when a energy ship arrives at a planet
country_event = {
	id = civtradebonus.6
	hide_window = yes
	is_triggered_only = yes
	trigger = {

	}
	immediate = {
		add_energy = 10
	}	
}

country_event = {
	id = civtradebonus.7
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		FROMFROMFROM.fleet = {
			has_fleet_flag = civilian_trade_fleet
		}
	}
	
	immediate = {
		THIS = {
			add_minerals = 50
			add_energy = 50
		}
	}
}